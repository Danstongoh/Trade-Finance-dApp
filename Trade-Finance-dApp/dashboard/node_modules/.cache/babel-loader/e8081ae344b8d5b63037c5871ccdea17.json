{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { store, reserveNextEntityId } from './store';\nimport useEntity from './useEntity';\nexport var createSetState = function createSetState(entity) {\n  return function (updates) {\n    entity.state = _extends({}, entity.state, {}, updates);\n\n    for (var i = 0; i < entity.subscribers.length; i++) {\n      entity.subscribers[i](entity.state);\n    }\n  };\n};\nexport var bindActions = function bindActions(actions, entity, deps) {\n  var entityActions = {};\n\n  for (var key in actions) {\n    if (typeof actions[key] === 'function') {\n      var action = actions[key](entity, deps);\n      if (typeof action !== 'function') throw new Error('Action must be defined using higher-order function.');\n      entityActions[key] = action;\n    }\n  }\n\n  return entityActions;\n};\nexport var createEntity = function createEntity(id, initialState, actions, deps) {\n  var entity = store[id] = {\n    state: initialState || {},\n    subscribers: [],\n    reset: function reset() {\n      entity.state = initialState;\n    }\n  };\n  entity.setState = createSetState(entity);\n  entity.actions = bindActions(actions, entity, deps);\n};\nexport var makeEntity = function makeEntity(_ref, deps) {\n  var initialState = _ref.initialState,\n      actions = _objectWithoutPropertiesLoose(_ref, [\"initialState\"]);\n\n  var id = reserveNextEntityId();\n  createEntity(id, initialState, actions, deps);\n  return function () {\n    return useEntity(id);\n  };\n};\nexport default makeEntity;","map":null,"metadata":{},"sourceType":"module"}